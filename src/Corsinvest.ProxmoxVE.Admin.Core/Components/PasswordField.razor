@*
 * SPDX-FileCopyrightText: Copyright Corsinvest Srl
 * SPDX-License-Identifier: AGPL-3.0-only
*@
@inherits AdminComponentBase

<RadzenFormField Text="@Label" Style="@Style" Helper="@Helper" @attributes="AdditionalAttributes" AllowFloatingLabel="false">
    <ChildContent>
        <RadzenPassword Value="@Value"
                        ValueChanged="@((string? value) => ValueChanged.InvokeAsync(value))"
                        Type="@(ShowPassword ? "text" : "password")"
                        Placeholder="@Placeholder"
                        Disabled="@Disabled"
                        ReadOnly="@ReadOnly"
                        Name="@Name"
                        AutoCompleteType="AutoCompleteType"
                        aria-label="@Label" />
    </ChildContent>
    <Start>
        <RadzenIcon Icon="password" />
    </Start>
    <End>
        @if (End != null)
        {
            @End
        }

@*
//TODO fix use icon
*@

        <RadzenToggleButton @bind-Value="@ShowPassword"
                            Icon="visibility"
                            ButtonStyle="ButtonStyle.Light"
                            ToggleIcon="visibility_off"
                            Variant="Variant.Flat"
                            Size="ButtonSize.ExtraSmall"
                            title="@(ShowPassword? L["Hide password"] : L["Show password"])"
                            aria-label="@(ShowPassword? L["Hide password"] : L["Show password"])" />
    </End>
</RadzenFormField>

@code {
    [Parameter] public string? Value { get; set; }
    [Parameter] public EventCallback<string?> ValueChanged { get; set; }
    [Parameter] public string Label { get; set; } = "Password";
    [Parameter] public string? Placeholder { get; set; }
    [Parameter] public bool Disabled { get; set; }
    [Parameter] public bool ReadOnly { get; set; }
    [Parameter] public string? Name { get; set; }
    [Parameter] public string Style { get; set; } = "width: 100%;";
    [Parameter] public RenderFragment? End { get; set; }
    [Parameter] public RenderFragment? Helper { get; set; }
    [Parameter] public AutoCompleteType AutoCompleteType { get; set; } = AutoCompleteType.On;
    [Parameter(CaptureUnmatchedValues = true)] public IReadOnlyDictionary<string, object>? AdditionalAttributes { get; set; }

    private bool ShowPassword { get; set; }
}
